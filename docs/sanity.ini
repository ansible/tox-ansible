[testenv:sanity-py3.12-devel]
description = Sanity tests using ansible-core devel and python 3.12
skip_install = True
deps =
  ansible-dev-environment>=26.2.0
allowlist_externals =
  ade
  bash
  echo
  git
  sh
commands_pre =
  bash -c 'ade install -e --venv {envdir} --acv devel --no-seed --im none .; rc=$?; if [ $rc -ne 0 ] && [ $rc -ne 2 ]; then exit $rc; fi'
  bash -c 'cd {envsitepackagesdir}/ansible_collections/ansible/sample && git config --global init.defaultBranch main && git init .'
commands =
  bash -c 'cd {envsitepackagesdir}/ansible_collections/ansible/sample && ansible-test sanity --local --requirements --python 3.12'
set_env =
  ANSIBLE_COLLECTIONS_PATH=.
  XDG_CACHE_HOME={envdir}/.cache
pass_env =
  GITHUB_TOKEN
